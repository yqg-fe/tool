{"version":3,"file":null,"sources":["../src/JsonTool/JsonDiffPatcher.js","../src/JsonTool/JsonTool.js","../src/main.js"],"sourcesContent":["/**\n * @author zhangpeng\n * @date 16/7/25-下午8:13\n * @file JsonDiffPatcher\n */\n\nimport jsondiffpatch from 'jsondiffpatch';\nexport default jsondiffpatch.create({\n    objectHash: (obj) => (obj._id || JSON.stringify(obj))   // eslint-disable-line no-underscore-dangle\n});\n","/**\n * @author zhangpeng\n * @date 16/7/25-下午5:55\n * @file json\n */\n\n// node modules\nimport extend from 'extend';\n\n// our modules\nimport JsonDiffPatcher from './JsonDiffPatcher';\n\nconst deepCopy = (obj) => extend(true, {}, obj);\n\n/**\n * Web Generator工具\n * templateA ------ patch1 ----------> page\n *     |            |                |\n *  patchA ----- transform -----> super patchA\n *    |            |                |\n * template -- super patch1----> expected page\n *\n * 根据page和patch求出保存page时的template版本[templateA]\n * 根据templateA和template求出patchA\n * 因为page和templateA同构，故对page直接进行patchA得到预期的页面\n *\n * @param template 当前最新版本的template\n * @param page 上一次保存的page\n * @param patch 上一次保存page时，page跟当时版本template的diff\n */\nconst patchPage = ({template, page, patch}) => {\n    const templateA = JsonDiffPatcher.unpatch(deepCopy(page), patch);\n    const patchA = JsonDiffPatcher.diff(templateA, template);\n\n    let result = deepCopy(page);\n    if (patchA) {\n        result = JsonDiffPatcher.patch(result, patchA);\n    }\n\n    return result;\n};\n\nexport default {\n    deepCopy,\n\n    diff: JsonDiffPatcher.diff.bind(JsonDiffPatcher),\n    patchPage\n};\n","/**\n * @author zhangpeng\n * @date 16/7/25-下午3:35\n * @file main\n */\n\nimport JsonTool from './JsonTool/JsonTool';\n\nexport default {\n    JsonTool\n};\n"],"names":[],"mappings":";;;;;;;;;;AAOA,0BAAe,cAAc,MAAd,CAAqB;AAChC,IAAA,cAAY,oBAAC,GAAD;AAAA,IAAA,WAAU,IAAI,GAAJ,IAAW,gBAAe,GAAf,CAArB;AAAA,IAAA,GADoB;AAAA,IAAA,CAArB,CAAf;;ICKA,IAAM,WAAW,SAAX,QAAW,CAAC,GAAD;AAAA,IAAA,WAAS,OAAO,IAAP,EAAa,EAAb,EAAiB,GAAjB,CAAT;AAAA,IAAA,CAAjB;;AAEA,IAAA;;;;;;;;;;;;;;;;AAgBA,IAAA,IAAM,YAAY,SAAZ,SAAY,OAA6B;AAAA,IAAA,QAA3B,QAA2B,QAA3B,QAA2B;AAAA,IAAA,QAAjB,IAAiB,QAAjB,IAAiB;AAAA,IAAA,QAAX,KAAW,QAAX,KAAW;;AAC3C,IAAA,QAAM,YAAY,gBAAgB,OAAhB,CAAwB,SAAS,IAAT,CAAxB,EAAwC,KAAxC,CAAlB;AACA,IAAA,QAAM,SAAS,gBAAgB,IAAhB,CAAqB,SAArB,EAAgC,QAAhC,CAAf;;AAEA,IAAA,QAAI,SAAS,SAAS,IAAT,CAAb;AACA,IAAA,QAAI,MAAJ,EAAY;AACR,IAAA,iBAAS,gBAAgB,KAAhB,CAAsB,MAAtB,EAA8B,MAA9B,CAAT;AACH,IAAA;;AAED,IAAA,WAAO,MAAP;AACH,IAAA,CAVD;;AAYA,mBAAe;AACX,IAAA,sBADW;;AAGX,IAAA,UAAM,gBAAgB,IAAhB,CAAqB,IAArB,CAA0B,eAA1B,CAHK;AAIX,IAAA;AAJW,IAAA,CAAf;;AClCA,eAAe;AACX,IAAA;AADW,IAAA,CAAf;;;;"}